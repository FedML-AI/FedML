# ARG BASE_IMAGE=python:3.11

# 使用 Windows Server Core 作为基础镜像
FROM mcr.microsoft.com/windows/servercore:ltsc2022

# 下载并安装 Python 3.11
SHELL ["powershell", "-Command"]
RUN Invoke-WebRequest -Uri https://www.python.org/ftp/python/3.11.0/python-3.11.0-amd64.exe -OutFile python-3.11.0-amd64.exe; \
    Start-Process python-3.11.0-amd64.exe -ArgumentList '/quiet InstallAllUsers=1 PrependPath=1' -NoNewWindow -Wait; \
    Remove-Item -Force python-3.11.0-amd64.exe

# Create a folder under the drive root
RUN mkdir actions-runner; cd actions-runner
# Download the latest runner package
RUN Invoke-WebRequest -Uri https://github.com/actions/runner/releases/download/v2.317.0/actions-runner-win-x64-2.317.0.zip -OutFile actions-runner-win-x64-2.317.0.zip
# Extract the installer
RUN Add-Type -AssemblyName System.IO.Compression.FileSystem ; [System.IO.Compression.ZipFile]::ExtractToDirectory("$PWD/actions-runner-win-x64-2.317.0.zip", "$PWD")

RUN ./config.cmd --url https://github.com/Qigemingziba/FedML --token AGMK3P3JNXYCBCEGMET7T6DGNQSVW
CMD ./run.cmd


